From: Samuel Thibault <samuel.thibault@ens-lyon.org>
Subject: [PATCH] Add fork hooks for pthread_atfork

2013-09-21  Samuel Thibault  <samuel.thibault@ens-lyon.org>

pthread_atfork needs application callbacks to be called outside any locking.

* sysdeps/mach/hurd/fork.c (_hurd_atfork_prepare_hook, _hurd_atfork_child_hook,
_hurd_atfork_parent_hook): New hooks.
(__fork): Call _hurd_atfork_prepare_hook hooks before all locking, call
_hurd_atfork_parent_hook or _hurd_atfork_child_hook after all unlocking.

Signed-off-by: Samuel Thibault <samuel.thibault@ens-lyon.org>
