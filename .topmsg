From git 22395607bcc8caa4dc9cf17f6fd141ea6395fcda and
f96ec27aa9f8fe871973b898ee407fe17681b6a7
