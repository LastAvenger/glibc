Subject: [PATCH] t/sendmmsg

From: Thomas Schwinge <thomas@codesourcery.com>

id:"87a9zubdm9.fsf@schwinge.name"

	* sysdeps/unix/sysv/linux/bits/socket.h (struct mmsghdr, recvmmsg)
	(sendmmsg): Move declarations...
	* socket/sys/socket.h: ... here.
	* socket/recvmmsg.c: New file.
	* socket/sendmmsg.c: New file.
	* sysdeps/unix/sysv/linux/internal_recvmmsg.S [__ASSUME_RECVMMSG]
	(recvmmsg): Rename to __recvmmsg, create weak alias and make
	definition of __recvmmsg hidden.
	* sysdeps/unix/sysv/linux/recvmmsg.c (recvmmsg): Likewise.
	Include <socket/recvmmsg.c> for ENOSYS stub.
	* sysdeps/unix/sysv/linux/internal_sendmmsg.S [__ASSUME_SENDMMSG]
	(sendmmsg): Rename to __sendmmsg, create weak alias and make
	definition of __sendmmsg hidden.
	* sysdeps/unix/sysv/linux/sendmmsg.c (sendmmsg): Likewise.
	Include <socket/sendmmsg.c> for ENOSYS stub.
	* sysdeps/unix/sysv/linux/Makefile [subdir=socket]
	(sysdep_routines): Move recvmmsg and sendmmsg...
	* socket/Makefile (routines): ... here.
	* socket/Versions (GLIBC_2.17): Add __sendmmsg, recvmmsg, and
	sendmmsg.
	* include/sys/socket.h (__recvmmsg, __sendmmsg): Add declarations.
	* resolv/res_send.c (send_dg): Invoke __sendmmsg instead of
	sendmmsg.
	* sysdeps/unix/sysv/linux/i386/nptl/libc.abilist (GLIBC_2.17): Add
	__sendmmsg.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/fpu/nptl/libc.abilist
	(GLIBC_2.17): Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/nptl/libc.abilist
	(GLIBC_2.17): Likewise.
	* sysdeps/unix/sysv/linux/s390/s390-32/nptl/libc.abilist
	(GLIBC_2.17): Likewise.
	* sysdeps/unix/sysv/linux/s390/s390-64/nptl/libc.abilist
	(GLIBC_2.17): Likewise.
	* sysdeps/unix/sysv/linux/sh/nptl/libc.abilist (GLIBC_2.17):
	Likewise.
	* sysdeps/unix/sysv/linux/sparc/sparc32/nptl/libc.abilist
	(GLIBC_2.17): Likewise.
	* sysdeps/unix/sysv/linux/sparc/sparc64/nptl/libc.abilist
	(GLIBC_2.17): Likewise.
	* sysdeps/unix/sysv/linux/x86_64/64/nptl/libc.abilist
	(GLIBC_2.17): Likewise.
	* sysdeps/unix/sysv/linux/x86_64/x32/nptl/libc.abilist
	(GLIBC_2.17): Likewise.

ports/
	* sysdeps/unix/sysv/linux/alpha/nptl/libc.abilist (GLIBC_2.17):
	Add __sendmmsg.
	* sysdeps/unix/sysv/linux/arm/nptl/libc.abilist (GLIBC_2.17):
	Likewise.
	* sysdeps/unix/sysv/linux/ia64/nptl/libc.abilist (GLIBC_2.17):
	Likewise.
	* sysdeps/unix/sysv/linux/m68k/coldfire/nptl/libc.abilist
	(GLIBC_2.17): Likewise.
	* sysdeps/unix/sysv/linux/m68k/m680x0/nptl/libc.abilist
	(GLIBC_2.17): Likewise.
	* sysdeps/unix/sysv/linux/mips/mips32/nptl/libc.abilist
	(GLIBC_2.17): Likewise.
	* sysdeps/unix/sysv/linux/mips/mips64/n32/nptl/libc.abilist
	(GLIBC_2.17): Likewise.
	* sysdeps/unix/sysv/linux/mips/mips64/n64/nptl/libc.abilist
	(GLIBC_2.17): Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/nofpu/nptl/libc.abilist
	(GLIBC_2.17): Likewise.
	* sysdeps/unix/sysv/linux/tile/tilegx/tilegx32/nptl/libc.abilist
	(GLIBC_2.17): Likewise.
	* sysdeps/unix/sysv/linux/tile/tilegx/tilegx64/nptl/libc.abilist
	(GLIBC_2.17): Likewise.
	* sysdeps/unix/sysv/linux/tile/tilepro/nptl/libc.abilist
	(GLIBC_2.17): Likewise.
